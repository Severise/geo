{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\julia\\\\Desktop\\\\geo\\\\geo\\\\src\\\\pages\\\\Test.js\";\nimport React, { Component } from 'react';\nimport { ReactComponent as Map } from \"@svgr/webpack?-svgo,+titleProp,+ref!../components/Map.svg\";\nimport list from '../components/list.json';\nimport _ from 'lodash';\nimport axios from 'axios';\nimport Head from '../components/Head.js';\nimport panzoom from 'panzoom';\nexport default class Learn extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      user: this.props.location.state.user,\n      current: {},\n      data: [],\n      results: {\n        name: '',\n        res: [],\n        sum: 0\n      },\n      status: ''\n    };\n    this.map = React.createRef();\n    this.handleClick = this.handleClick.bind(this);\n    this.handleChoose = this.handleChoose.bind(this);\n    this.handleStart = this.handleStart.bind(this);\n    this.saveResults = this.saveResults.bind(this);\n  }\n\n  componentDidMount() {\n    panzoom(this.map.current, {\n      smoothScroll: false,\n      bounds: true,\n      boundsPadding: 0.1,\n      maxZoom: 4,\n      minZoom: 0.8\n    });\n  }\n\n  handleStart() {\n    var i;\n    var min = 0;\n    var max = 1;\n\n    if (this.state.data.length < 1) {\n      this.setState({\n        current: {\n          name: ''\n        }\n      }, this.count);\n    } else {\n      min = this.state.data[0].id;\n      max = this.state.data.length + min;\n      i = parseInt(Math.random() * (max - min) + min);\n      i = i - min;\n      this.setState({\n        current: {\n          id: this.state.data[i].id,\n          name: this.state.data[i].name,\n          try: 0\n        }\n      });\n      this.state.data.splice(i, 1);\n    }\n  }\n\n  handleClick(event) {\n    if (!this.state.current.id) {\n      return;\n    }\n\n    var layer = event.target.parentElement.getAttribute('id');\n\n    if (layer !== document.getElementsByClassName('chosen')[0].getAttribute('class').split(' ')[0]) {\n      return;\n    }\n\n    if (parseInt(event.target.getAttribute('id')) !== this.state.current.id) {\n      if (!event.target.classList.contains('right')) {\n        this.setState({\n          current: {\n            id: this.state.current.id,\n            name: this.state.current.name,\n            try: this.state.current.try + 1\n          }\n        });\n      }\n\n      event.target.classList.add('wrong');\n      return;\n    } else {\n      event.target.classList.add('right');\n      var a = document.getElementsByClassName('wrong');\n\n      for (var i = a.length - 1; i >= 0; i--) {\n        a[i].classList.remove('wrong');\n      }\n\n      var name = document.getElementsByClassName('chosen')[0].getAttribute('class').split(' ')[0];\n      this.setState({\n        results: {\n          name: name,\n          res: this.state.results.res.concat([this.state.current]),\n          sum: this.state.results.sum\n        }\n      }, this.handleStart);\n    }\n  }\n\n  handleChoose(event) {\n    this.setState({\n      status: ''\n    });\n    var cur = event.target.className;\n    var prev;\n    this.setState({\n      results: {\n        name: '',\n        res: [],\n        sum: 0\n      }\n    });\n\n    if (document.getElementsByClassName('chosen')[0]) {\n      prev = document.getElementsByClassName('chosen')[0];\n\n      if (event.target.classList.contains(prev.getAttribute('class').split(' ')[0])) {\n        return;\n      }\n\n      prev.classList.remove('chosen');\n      prev = prev.getAttribute('class').split(' ')[0];\n      var a = document.getElementsByClassName('wrong');\n      var b = document.getElementsByClassName('right');\n\n      for (var i = a.length - 1; i >= 0; i--) {\n        a[i].classList.remove('wrong');\n      }\n\n      for (var j = b.length - 1; j >= 0; j--) {\n        b[j].classList.remove('right');\n      }\n\n      document.getElementById(prev).style.display = 'none';\n    }\n\n    document.getElementById('region').style.display = 'inline';\n    document.getElementById(cur).style.display = 'inline';\n    document.getElementsByTagName('svg')[0].getElementsByClassName('active')[0].classList.remove('active');\n    document.getElementsByTagName('svg')[0].getElementById(cur).classList.add('active');\n    event.target.classList.add('chosen');\n\n    var clone = _.cloneDeep(list);\n\n    clone = clone[cur];\n    this.setState({\n      data: clone\n    }, this.handleStart);\n  }\n\n  count() {\n    var res = this.state.results.res;\n    var item;\n    var sum = 0;\n\n    for (var i = 0; i < res.length; i++) {\n      item = 1. - res[i].try / 3;\n      item = item > 0 ? item : 0;\n      item = 100. / res.length * item;\n      sum += item;\n    }\n\n    this.setState({\n      results: {\n        name: this.state.results.name,\n        res: this.state.results.res,\n        sum: Math.round(sum)\n      }\n    }, this.saveResults);\n  }\n\n  saveResults() {\n    if (!this.state.user.id || !this.state.user.className) {\n      this.setState({\n        status: /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 13\n          }\n        }, \"\\u0412\\u044B \\u043D\\u0430\\u0431\\u0440\\u0430\\u043B\\u0438 \", this.state.results.sum, \"%\")\n      });\n      return;\n    }\n\n    axios.post('saveresults', {\n      results: this.state.results,\n      id: this.state.user.id\n    }).then(res => {\n      this.setState({\n        status: /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }\n        }, \"\\u0412\\u0430\\u0448 \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442 \\u0431\\u044B\\u043B \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D, \\u0412\\u044B \\u043D\\u0430\\u0431\\u0440\\u0430\\u043B\\u0438 \", this.state.results.sum, \"%\")\n      });\n    }).catch(error => {\n      if (error.response.status === 304) {\n        this.setState({\n          status: /*#__PURE__*/React.createElement(\"div\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 14\n            }\n          }, \"\\u0422\\u0435\\u0441\\u0442 \\u0443\\u0436\\u0435 \\u043F\\u0440\\u043E\\u0439\\u0434\\u0435\\u043D, \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442 \\u043D\\u0435 \\u0431\\u044B\\u043B \\u0441\\u043E\\u0445\\u0440\\u0430\\u043D\\u0435\\u043D, \\u0412\\u044B \\u043D\\u0430\\u0431\\u0440\\u0430\\u043B\\u0438 \", this.state.results.sum, \"%\")\n        });\n      } else {\n        this.setState({\n          status: 'Ошибка, попробуйте пройти еще раз'\n        });\n      }\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(Head, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 5\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      onClick: this.saveResults,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 7\n      }\n    }, \"\\u0418\\u0440\\u043A\\u0443\\u0442\\u0441\\u043A\\u0430\\u044F \\u043E\\u0431\\u043B\\u0430\\u0441\\u0442\\u044C\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"map\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Map, {\n      id: \"irkutsk\",\n      ref: this.map,\n      onClick: this.handleClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 8\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"side\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      id: \"layers\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      className: \"region\",\n      onClick: this.handleChoose,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 8\n      }\n    }, \"\\u0420\\u0430\\u0439\\u043E\\u043D\\u044B\"), /*#__PURE__*/React.createElement(\"li\", {\n      className: \"city\",\n      onClick: this.handleChoose,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 8\n      }\n    }, \"\\u0413\\u043E\\u0440\\u043E\\u0434\\u0430\"), /*#__PURE__*/React.createElement(\"li\", {\n      className: \"river\",\n      onClick: this.handleChoose,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 8\n      }\n    }, \"\\u0420\\u0435\\u043A\\u0438\"), /*#__PURE__*/React.createElement(\"li\", {\n      className: \"place\",\n      onClick: this.handleChoose,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 8\n      }\n    }, \"\\u041C\\u0435\\u0441\\u0442\\u0430\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 7\n      }\n    }, this.state.current.id == null ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 42\n      }\n    }, \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0441\\u043B\\u043E\\u0439 \\u0434\\u043B\\u044F \\u0442\\u0435\\u0441\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F\") : /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 89\n      }\n    }, \"\\u041D\\u0430\\u0439\\u0434\\u0438\\u0442\\u0435 \\u0437\\u0430\\u0434\\u0430\\u043D\\u043D\\u044B\\u0439 \\u043E\\u0431\\u044A\\u0435\\u043A\\u0442: \", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 119\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 10\n      }\n    }, this.state.current.name), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 48\n      }\n    }), \"\\u041F\\u043E\\u043F\\u044B\\u0442\\u043E\\u043A: \", this.state.current.try), this.state.status))));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/julia/Desktop/geo/geo/src/pages/Test.js"],"names":["React","Component","list","_","axios","Head","panzoom","Learn","constructor","props","state","user","location","current","data","results","name","res","sum","status","map","createRef","handleClick","bind","handleChoose","handleStart","saveResults","componentDidMount","smoothScroll","bounds","boundsPadding","maxZoom","minZoom","i","min","max","length","setState","count","id","parseInt","Math","random","try","splice","event","layer","target","parentElement","getAttribute","document","getElementsByClassName","split","classList","contains","add","a","remove","concat","cur","className","prev","b","j","getElementById","style","display","getElementsByTagName","clone","cloneDeep","item","round","post","then","catch","error","response","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { ReactComponent as Map } from '../components/Map.svg';\r\nimport list from '../components/list.json';\r\nimport _ from 'lodash';\r\nimport axios from 'axios';\r\nimport Head from '../components/Head.js';\r\nimport panzoom from 'panzoom'\r\n\r\nexport default class Learn extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tuser: this.props.location.state.user,\r\n\t\t\tcurrent: {},\r\n\t\t\tdata: [],\r\n\t\t\tresults: {\r\n\t\t\t\tname: '',\r\n\t\t\t\tres: [],\r\n\t\t\t\tsum: 0\r\n\t\t\t},\r\n\t\t\tstatus: ''\r\n\t\t};\r\n\t\tthis.map = React.createRef();\r\n\t\tthis.handleClick = this.handleClick.bind(this);\r\n\t\tthis.handleChoose = this.handleChoose.bind(this);\r\n\t\tthis.handleStart = this.handleStart.bind(this);\r\n\t\tthis.saveResults = this.saveResults.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tpanzoom(this.map.current, {\r\n\t\t\tsmoothScroll: false,\r\n\t\t\tbounds: true,\r\n\t\t\tboundsPadding: 0.1,\r\n\t\t\tmaxZoom: 4,\r\n\t\t\tminZoom: 0.8\r\n\t\t});\r\n\t}\r\n\r\n\thandleStart() {\r\n\t\tvar i;\r\n\t\tvar min = 0;\r\n\t\tvar max = 1;\r\n\r\n\t\tif (this.state.data.length < 1) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: {\r\n\t\t\t\t\tname: ''\r\n\t\t\t\t}\r\n\t\t\t}, this.count);\r\n\t\t} else {\r\n\t\t\tmin = this.state.data[0].id;\r\n\t\t\tmax = this.state.data.length + min;\r\n\t\t\ti = parseInt(Math.random() * (max - min) + min);\r\n\t\t\ti = i - min;\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: {\r\n\t\t\t\t\tid: this.state.data[i].id,\r\n\t\t\t\t\tname: this.state.data[i].name,\r\n\t\t\t\t\ttry: 0\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.state.data.splice(i, 1)\r\n\t\t}\r\n\t}\r\n\r\n\r\n\thandleClick(event) {\r\n\t\tif (!this.state.current.id) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tvar layer = event.target.parentElement.getAttribute('id');\r\n\t\tif (layer !== document.getElementsByClassName('chosen')[0].getAttribute('class').split(' ')[0]) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (parseInt(event.target.getAttribute('id')) !== this.state.current.id) {\r\n\t\t\tif (!event.target.classList.contains('right')) {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tcurrent: {\r\n\t\t\t\t\t\tid: this.state.current.id,\r\n\t\t\t\t\t\tname: this.state.current.name,\r\n\t\t\t\t\t\ttry: this.state.current.try + 1\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tevent.target.classList.add('wrong');\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\tevent.target.classList.add('right');\r\n\t\t\tvar a = document.getElementsByClassName('wrong');\r\n\t\t\tfor (var i = a.length - 1; i >= 0; i--) {\r\n\t\t\t\ta[i].classList.remove('wrong');\r\n\t\t\t}\r\n\t\t\tvar name = document.getElementsByClassName('chosen')[0].getAttribute('class').split(' ')[0];\r\n\t\t\tthis.setState({\r\n\t\t\t\tresults: {\r\n\t\t\t\t\tname: name,\r\n\t\t\t\t\tres: this.state.results.res.concat([this.state.current]),\r\n\t\t\t\t\tsum: this.state.results.sum\r\n\t\t\t\t}\r\n\t\t\t}, this.handleStart);\r\n\t\t}\r\n\t}\r\n\r\n\thandleChoose(event) {\r\n\t\tthis.setState({\r\n\t\t\tstatus: ''\r\n\t\t});\r\n\t\tvar cur = event.target.className;\r\n\t\tvar prev;\r\n\t\tthis.setState({\r\n\t\t\tresults: {\r\n\t\t\t\tname: '',\r\n\t\t\t\tres: [],\r\n\t\t\t\tsum: 0\r\n\t\t\t}\r\n\t\t})\r\n\t\tif (document.getElementsByClassName('chosen')[0]) {\r\n\t\t\tprev = document.getElementsByClassName('chosen')[0];\r\n\t\t\tif (event.target.classList.contains(prev.getAttribute('class').split(' ')[0])) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tprev.classList.remove('chosen');\r\n\t\t\tprev = prev.getAttribute('class').split(' ')[0];\r\n\t\t\tvar a = document.getElementsByClassName('wrong');\r\n\t\t\tvar b = document.getElementsByClassName('right');\r\n\t\t\tfor (var i = a.length - 1; i >= 0; i--) {\r\n\t\t\t\ta[i].classList.remove('wrong');\r\n\t\t\t}\r\n\t\t\tfor (var j = b.length - 1; j >= 0; j--) {\r\n\t\t\t\tb[j].classList.remove('right');\r\n\t\t\t}\r\n\t\t\tdocument.getElementById(prev).style.display = 'none';\r\n\t\t}\r\n\t\tdocument.getElementById('region').style.display = 'inline';\r\n\t\tdocument.getElementById(cur).style.display = 'inline';\r\n\t\tdocument.getElementsByTagName('svg')[0].getElementsByClassName('active')[0].classList.remove('active');\r\n\t\tdocument.getElementsByTagName('svg')[0].getElementById(cur).classList.add('active');\r\n\t\tevent.target.classList.add('chosen');\r\n\t\tvar clone = _.cloneDeep(list);\r\n\t\tclone = clone[cur];\r\n\t\tthis.setState({\r\n\t\t\tdata: clone\r\n\t\t}, this.handleStart);\r\n\t}\r\n\r\n\tcount() {\r\n\t\tvar res = this.state.results.res;\r\n\t\tvar item;\r\n\t\tvar sum = 0;\r\n\t\tfor (var i = 0; i < res.length; i++) {\r\n\t\t\titem = 1. - (res[i].try / 3);\r\n\t\t\titem = item > 0 ? item : 0;\r\n\t\t\titem = (100. / res.length) * item;\r\n\t\t\tsum += item;\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tresults: {\r\n\t\t\t\tname: this.state.results.name,\r\n\t\t\t\tres: this.state.results.res,\r\n\t\t\t\tsum: Math.round(sum)\r\n\t\t\t}\r\n\t\t}, this.saveResults);\r\n\t}\r\n\r\n\tsaveResults() {\r\n\t\tif (!this.state.user.id || !this.state.user.className) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tstatus: <div>Вы набрали {this.state.results.sum}%</div>\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\taxios.post('saveresults', {\r\n\t\t\tresults: this.state.results,\r\n\t\t\tid: this.state.user.id\r\n\t\t}).then(res => {\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tstatus: <div>Ваш результат был сохранен, Вы набрали {this.state.results.sum}%</div>\r\n\t\t\t});\r\n\t\t}).catch(error => {\r\n\t\t\tif (error.response.status === 304) {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tstatus: <div>Тест уже пройден, результат не был сохранен, Вы набрали {this.state.results.sum}%</div>\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tstatus: 'Ошибка, попробуйте пройти еще раз'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<Head/>\r\n\t\t\t\t<div id=\"body\">\r\n\t\t\t\t\t<div id=\"content\">\r\n\t\t\t\t\t\t<h2 onClick={this.saveResults}>Иркутская область</h2>\r\n\t\t\t\t\t\t<div id=\"map\">\r\n\t\t\t\t\t\t\t<Map id=\"irkutsk\" ref={this.map} onClick={this.handleClick}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div id=\"side\">\r\n\t\t\t\t\t\t<ul id=\"layers\">\r\n\t\t\t\t\t\t\t<li className=\"region\" onClick={this.handleChoose}>Районы</li>\r\n\t\t\t\t\t\t\t<li className=\"city\" onClick={this.handleChoose}>Города</li>\r\n\t\t\t\t\t\t\t<li className=\"river\" onClick={this.handleChoose}>Реки</li>\r\n\t\t\t\t\t\t\t<li className=\"place\" onClick={this.handleChoose}>Места</li>\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{this.state.current.id == null ? (<div>Выберите слой для тестирования</div> ) : (<div>Найдите заданный объект: <br/>\r\n\t\t\t\t\t\t\t\t\t<span>{this.state.current.name}</span><br/>\r\n\t\t\t\t\t\t\t\t\tПопыток: {this.state.current.try}</div>)}\r\n\t\t\t\t\t\t\t\t\t{this.state.status}\r\n\t\t\t\t\t\t</div>\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t);\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}