{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\julia\\\\Desktop\\\\geo\\\\geo\\\\src\\\\pages\\\\Login.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport * as jwt_decode from 'jwt-decode';\nimport Head from '../components/Head.js';\nexport default class Sign extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      login: '',\n      password: '',\n      role: 'teacher',\n      schoolName: '',\n      school: '',\n      newSchool: '',\n      name: '',\n      status: '',\n      schools: []\n    };\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    axios.get(`/schools`).then(res => {\n      this.setState({\n        schools: res.data\n      });\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  handleChange(event) {\n    if (event.target.name === 'school') {\n      this.setState({\n        schoolname: event.target.value\n      });\n    }\n\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n    var radio = document.getElementsByName('form');\n\n    for (var i = 0; i < radio.length; i++) {\n      if (radio[i].checked) {\n        var path = radio[i].id;\n      }\n    }\n\n    if (path === 'signin') {\n      axios.post(path, {\n        login: this.state.login,\n        password: this.state.password,\n        role: this.state.role\n      }).then(res => {\n        localStorage.setItem('token', res.data);\n        var token = jwt_decode(res.data);\n\n        if (token.class) {\n          this.props.history.push({\n            pathname: `/student`,\n            state: {\n              user: token\n            }\n          });\n        } else if (token.school) {\n          this.props.history.push({\n            pathname: `/teacher`,\n            state: {\n              user: token\n            }\n          });\n        }\n      }).catch(error => {\n        this.setState({\n          status: /*#__PURE__*/React.createElement(\"div\", {\n            className: \"error\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 14\n            }\n          }, \"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\")\n        });\n      });\n    } else {\n      axios.post(path, {\n        name: this.state.name,\n        login: this.state.login,\n        password: this.state.password,\n        school: this.state.school,\n        newSchool: this.state.newSchool\n      }).then(res => {\n        if (res.data) {\n          this.setState({\n            status: /*#__PURE__*/React.createElement(\"div\", {\n              className: \"success\",\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 88,\n                columnNumber: 15\n              }\n            }, \"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F \\u043F\\u0440\\u043E\\u0439\\u0434\\u0435\\u043D\\u0430\")\n          });\n          this.setState({\n            name: '',\n            login: '',\n            password: '',\n            school: '',\n            newSchool: ''\n          });\n          document.getElementById('signin').checked = true;\n        } else {\n          this.setState({\n            status: /*#__PURE__*/React.createElement(\"div\", {\n              className: \"error\",\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 100,\n                columnNumber: 15\n              }\n            }, \"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C \\u0443\\u0436\\u0435 \\u0441\\u0443\\u0449\\u0435\\u0441\\u0442\\u0432\\u0443\\u0435\\u0442\")\n          });\n        }\n      }).catch(error => {\n        if (error.response.status == 304) {\n          return;\n        }\n\n        this.setState({\n          status: /*#__PURE__*/React.createElement(\"div\", {\n            className: \"error\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 14\n            }\n          }, \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u0438\")\n        });\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(Head, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 5\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"form\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      id: \"signin\",\n      name: \"form\",\n      value: \"\",\n      defaultChecked: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 7\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"signin\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 7\n      }\n    }, \"\\u0412\\u0445\\u043E\\u0434\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"sign\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 8\n      }\n    }, \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u0434\\u043B\\u044F \\u0432\\u0445\\u043E\\u0434\\u0430\"), this.state.status, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 8\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 10\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 14\n      }\n    }, \"\\u041B\\u043E\\u0433\\u0438\\u043D\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      name: \"login\",\n      value: this.state.login,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 10\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"password\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 14\n      }\n    }, \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      name: \"password\",\n      value: this.state.password,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 11\n      }\n    }, \"\\u0420\\u043E\\u043B\\u044C\"), /*#__PURE__*/React.createElement(\"li\", {\n      className: \"radio\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 10\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      id: \"teach\",\n      name: \"role\",\n      value: \"teacher\",\n      onChange: this.handleChange,\n      defaultChecked: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 32\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"teach\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 11\n      }\n    }, \"\\u0423\\u0447\\u0438\\u0442\\u0435\\u043B\\u044C\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 11\n      }\n    }, \" / \"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      id: \"stud\",\n      name: \"role\",\n      value: \"student\",\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"stud\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 11\n      }\n    }, \"\\u0423\\u0447\\u0435\\u043D\\u0438\\u043A\")), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 10\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 14\n      }\n    }, \"\\u0412\\u043E\\u0439\\u0442\\u0438\"))))), /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 7\n      }\n    }, \" / \"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"radio\",\n      id: \"signup\",\n      name: \"form\",\n      value: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 7\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"signup\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 7\n      }\n    }, \"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\"), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"reg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 7\n      }\n    }, \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435\"), this.state.status, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 8\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 13\n      }\n    }, \"\\u0418\\u043C\\u044F\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      name: \"name\",\n      value: this.state.name,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 10\n      }\n    })), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 13\n      }\n    }, \"\\u041B\\u043E\\u0433\\u0438\\u043D\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      name: \"login\",\n      autoComplete: \"off\",\n      value: this.state.login,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 10\n      }\n    })), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"password\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 13\n      }\n    }, \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      name: \"password\",\n      autoComplete: \"off\",\n      value: this.state.password,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 10\n      }\n    })), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"school\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 10\n      }\n    }, \"\\u0428\\u043A\\u043E\\u043B\\u0430\"), /*#__PURE__*/React.createElement(\"select\", {\n      name: \"school\",\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 10\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 10\n      }\n    }), this.state.schools.map(item => /*#__PURE__*/React.createElement(\"option\", {\n      key: item.id,\n      value: item.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 43\n      }\n    }, item.name)), \";\")), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"newSchool\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 13\n      }\n    }, \"\\u041D\\u043E\\u0432\\u0430\\u044F \\u0448\\u043A\\u043E\\u043B\\u0430\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      name: \"newSchool\",\n      value: this.state.newSchool,\n      placeholder: \"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0439\\u0442\\u0435 \\u043D\\u043E\\u0432\\u0443\\u044E \\u0435\\u0441\\u043B\\u0438 \\u0432\\u0430\\u0448\\u0435\\u0439 \\u043D\\u0435\\u0442 \\u0432 \\u0441\\u043F\\u0438\\u0441\\u043A\\u0435\",\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 10\n      }\n    })), /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 13\n      }\n    }, \"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\")))))));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/julia/Desktop/geo/geo/src/pages/Login.js"],"names":["React","Component","axios","jwt_decode","Head","Sign","constructor","props","state","login","password","role","schoolName","school","newSchool","name","status","schools","handleSubmit","bind","handleChange","get","then","res","setState","data","catch","error","console","log","event","target","schoolname","value","preventDefault","radio","document","getElementsByName","i","length","checked","path","id","post","localStorage","setItem","token","class","history","push","pathname","user","getElementById","response","render","map","item"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAO,KAAKC,UAAZ,MAA4B,YAA5B;AACA,OAAOC,IAAP,MAAiB,uBAAjB;AAEA,eAAe,MAAMC,IAAN,SAAmBJ,SAAnB,CAA6B;AAC3CK,EAAAA,WAAW,CAACC,KAAD,EAAQ;AAClB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACZC,MAAAA,KAAK,EAAE,EADK;AAEZC,MAAAA,QAAQ,EAAE,EAFE;AAGZC,MAAAA,IAAI,EAAE,SAHM;AAIZC,MAAAA,UAAU,EAAE,EAJA;AAKZC,MAAAA,MAAM,EAAE,EALI;AAMZC,MAAAA,SAAS,EAAE,EANC;AAOZC,MAAAA,IAAI,EAAE,EAPM;AAQZC,MAAAA,MAAM,EAAE,EARI;AASZC,MAAAA,OAAO,EAAE;AATG,KAAb;AAWA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAApB;AACAjB,IAAAA,KAAK,CAACmB,GAAN,CAAW,UAAX,EAAsBC,IAAtB,CAA2BC,GAAG,IAAI;AACjC,WAAKC,QAAL,CAAc;AACbP,QAAAA,OAAO,EAAEM,GAAG,CAACE;AADA,OAAd;AAGA,KAJD,EAIGC,KAJH,CAISC,KAAK,IAAI;AACjBC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACA,KAND;AAOA;;AAEDP,EAAAA,YAAY,CAACU,KAAD,EAAQ;AACnB,QAAIA,KAAK,CAACC,MAAN,CAAahB,IAAb,KAAsB,QAA1B,EAAoC;AACnC,WAAKS,QAAL,CAAc;AACbQ,QAAAA,UAAU,EAAEF,KAAK,CAACC,MAAN,CAAaE;AADZ,OAAd;AAGA;;AACD,SAAKT,QAAL,CAAc;AACb,OAACM,KAAK,CAACC,MAAN,CAAahB,IAAd,GAAqBe,KAAK,CAACC,MAAN,CAAaE;AADrB,KAAd;AAGA;;AAEDf,EAAAA,YAAY,CAACY,KAAD,EAAQ;AACnBA,IAAAA,KAAK,CAACI,cAAN;AACA,QAAIC,KAAK,GAAGC,QAAQ,CAACC,iBAAT,CAA2B,MAA3B,CAAZ;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,KAAK,CAACI,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AACtC,UAAIH,KAAK,CAACG,CAAD,CAAL,CAASE,OAAb,EAAsB;AACrB,YAAIC,IAAI,GAAGN,KAAK,CAACG,CAAD,CAAL,CAASI,EAApB;AACA;AACD;;AACD,QAAID,IAAI,KAAK,QAAb,EAAuB;AACtBvC,MAAAA,KAAK,CAACyC,IAAN,CAAWF,IAAX,EAAiB;AAChBhC,QAAAA,KAAK,EAAE,KAAKD,KAAL,CAAWC,KADF;AAEhBC,QAAAA,QAAQ,EAAE,KAAKF,KAAL,CAAWE,QAFL;AAGhBC,QAAAA,IAAI,EAAE,KAAKH,KAAL,CAAWG;AAHD,OAAjB,EAIGW,IAJH,CAIQC,GAAG,IAAI;AACdqB,QAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BtB,GAAG,CAACE,IAAlC;AACA,YAAIqB,KAAK,GAAG3C,UAAU,CAACoB,GAAG,CAACE,IAAL,CAAtB;;AACA,YAAIqB,KAAK,CAACC,KAAV,EAAiB;AAChB,eAAKxC,KAAL,CAAWyC,OAAX,CAAmBC,IAAnB,CAAwB;AACvBC,YAAAA,QAAQ,EAAG,UADY;AAEvB1C,YAAAA,KAAK,EAAE;AACN2C,cAAAA,IAAI,EAAEL;AADA;AAFgB,WAAxB;AAMA,SAPD,MAOO,IAAIA,KAAK,CAACjC,MAAV,EAAkB;AACxB,eAAKN,KAAL,CAAWyC,OAAX,CAAmBC,IAAnB,CAAwB;AACvBC,YAAAA,QAAQ,EAAG,UADY;AAEvB1C,YAAAA,KAAK,EAAE;AACN2C,cAAAA,IAAI,EAAEL;AADA;AAFgB,WAAxB;AAMA;AACD,OAtBD,EAsBGpB,KAtBH,CAsBSC,KAAK,IAAI;AACjB,aAAKH,QAAL,CAAc;AACbR,UAAAA,MAAM,eAAE;AAAK,YAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADK,SAAd;AAGA,OA1BD;AA2BA,KA5BD,MA4BO;AACNd,MAAAA,KAAK,CAACyC,IAAN,CAAWF,IAAX,EAAiB;AAChB1B,QAAAA,IAAI,EAAE,KAAKP,KAAL,CAAWO,IADD;AAEhBN,QAAAA,KAAK,EAAE,KAAKD,KAAL,CAAWC,KAFF;AAGhBC,QAAAA,QAAQ,EAAE,KAAKF,KAAL,CAAWE,QAHL;AAIhBG,QAAAA,MAAM,EAAE,KAAKL,KAAL,CAAWK,MAJH;AAKhBC,QAAAA,SAAS,EAAE,KAAKN,KAAL,CAAWM;AALN,OAAjB,EAMGQ,IANH,CAMQC,GAAG,IAAI;AACd,YAAIA,GAAG,CAACE,IAAR,EAAc;AACb,eAAKD,QAAL,CAAc;AACbR,YAAAA,MAAM,eAAE;AAAK,cAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADK,WAAd;AAGA,eAAKQ,QAAL,CAAc;AACbT,YAAAA,IAAI,EAAE,EADO;AAEbN,YAAAA,KAAK,EAAE,EAFM;AAGbC,YAAAA,QAAQ,EAAE,EAHG;AAIbG,YAAAA,MAAM,EAAE,EAJK;AAKbC,YAAAA,SAAS,EAAE;AALE,WAAd;AAOAsB,UAAAA,QAAQ,CAACgB,cAAT,CAAwB,QAAxB,EAAkCZ,OAAlC,GAA4C,IAA5C;AACA,SAZD,MAYO;AACN,eAAKhB,QAAL,CAAc;AACbR,YAAAA,MAAM,eAAE;AAAK,cAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADK,WAAd;AAGA;AACD,OAxBD,EAwBGU,KAxBH,CAwBSC,KAAK,IAAI;AACjB,YAAIA,KAAK,CAAC0B,QAAN,CAAerC,MAAf,IAAyB,GAA7B,EAAkC;AACjC;AACA;;AACD,aAAKQ,QAAL,CAAc;AACbR,UAAAA,MAAM,eAAE;AAAK,YAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADK,SAAd;AAGA,OA/BD;AAgCA;AACD;;AAEDsC,EAAAA,MAAM,GAAG;AACR,wBACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACC,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,eAEC;AAAK,MAAA,EAAE,EAAC,MAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAO,MAAA,IAAI,EAAC,OAAZ;AAAoB,MAAA,EAAE,EAAC,QAAvB;AAAgC,MAAA,IAAI,EAAC,MAArC;AAA4C,MAAA,KAAK,EAAC,EAAlD;AAAqD,MAAA,cAAc,MAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAEE;AAAO,MAAA,OAAO,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAFF,eAGE;AAAK,MAAA,EAAE,EAAC,MAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2IADD,EAEE,KAAK9C,KAAL,CAAWQ,MAFb,eAGC;AAAM,MAAA,QAAQ,EAAE,KAAKE,YAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAI;AAAO,MAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCAAJ,eACC;AAAO,MAAA,IAAI,EAAC,MAAZ;AAAmB,MAAA,IAAI,EAAC,OAAxB;AAAgC,MAAA,KAAK,EAAE,KAAKV,KAAL,CAAWC,KAAlD;AAAyD,MAAA,QAAQ,EAAE,KAAKW,YAAxE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,CADD,eAGC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAI;AAAO,MAAA,OAAO,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CAAJ,eACC;AAAO,MAAA,IAAI,EAAC,UAAZ;AAAuB,MAAA,IAAI,EAAC,UAA5B;AAAuC,MAAA,KAAK,EAAE,KAAKZ,KAAL,CAAWE,QAAzD;AAAmE,MAAA,QAAQ,EAAE,KAAKU,YAAlF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,CAHD,eAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCALF,eAMC;AAAI,MAAA,SAAS,EAAC,OAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAsB;AAAO,MAAA,IAAI,EAAC,OAAZ;AAAoB,MAAA,EAAE,EAAC,OAAvB;AAA+B,MAAA,IAAI,EAAC,MAApC;AAA2C,MAAA,KAAK,EAAC,SAAjD;AAA2D,MAAA,QAAQ,EAAE,KAAKA,YAA1E;AAAwF,MAAA,cAAc,MAAtG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAtB,eACC;AAAO,MAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oDADD,eAEC;AAAO,MAAA,IAAI,EAAC,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFD,eAGC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAHD,eAIC;AAAO,MAAA,IAAI,EAAC,OAAZ;AAAoB,MAAA,EAAE,EAAC,MAAvB;AAA8B,MAAA,IAAI,EAAC,MAAnC;AAA2C,MAAA,KAAK,EAAC,SAAjD;AAA2D,MAAA,QAAQ,EAAE,KAAKA,YAA1E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJD,eAKC;AAAO,MAAA,OAAO,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CALD,CAND,eAYC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAI;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCAAJ,CAZD,CADD,CAHD,CAHF,eAuBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAvBF,eAwBE;AAAO,MAAA,IAAI,EAAC,OAAZ;AAAoB,MAAA,EAAE,EAAC,QAAvB;AAAgC,MAAA,IAAI,EAAC,MAArC;AAA4C,MAAA,KAAK,EAAC,EAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAxBF,eAyBE;AAAO,MAAA,OAAO,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4EAzBF,eA0BC;AAAK,MAAA,EAAE,EAAC,KAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yFADD,EAEE,KAAKZ,KAAL,CAAWQ,MAFb,eAGC;AAAM,MAAA,QAAQ,EAAE,KAAKE,YAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAI;AAAO,MAAA,OAAO,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAAJ,eACC;AAAO,MAAA,IAAI,EAAC,MAAZ;AAAmB,MAAA,IAAI,EAAC,MAAxB;AAA+B,MAAA,KAAK,EAAE,KAAKV,KAAL,CAAWO,IAAjD;AAAuD,MAAA,QAAQ,EAAE,KAAKK,YAAtE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,CADD,eAGC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAI;AAAO,MAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCAAJ,eACC;AAAO,MAAA,IAAI,EAAC,MAAZ;AAAmB,MAAA,IAAI,EAAC,OAAxB;AAAiC,MAAA,YAAY,EAAC,KAA9C;AAAoD,MAAA,KAAK,EAAE,KAAKZ,KAAL,CAAWC,KAAtE;AAA6E,MAAA,QAAQ,EAAE,KAAKW,YAA5F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,CAHD,eAKC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAI;AAAO,MAAA,OAAO,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CAAJ,eACC;AAAO,MAAA,IAAI,EAAC,UAAZ;AAAuB,MAAA,IAAI,EAAC,UAA5B;AAAwC,MAAA,YAAY,EAAC,KAArD;AAA2D,MAAA,KAAK,EAAE,KAAKZ,KAAL,CAAWE,QAA7E;AAAuF,MAAA,QAAQ,EAAE,KAAKU,YAAtG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,CALD,eAQC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACC;AAAO,MAAA,OAAO,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCADD,eAEC;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAsB,MAAA,QAAQ,EAAE,KAAKA,YAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACA;AAAQ,MAAA,KAAK,EAAC,EAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,EAEE,KAAKZ,KAAL,CAAWS,OAAX,CAAmBsC,GAAnB,CAAuBC,IAAI,iBAAI;AAAQ,MAAA,GAAG,EAAEA,IAAI,CAACd,EAAlB;AAAsB,MAAA,KAAK,EAAEc,IAAI,CAACd,EAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAuCc,IAAI,CAACzC,IAA5C,CAA/B,CAFF,MAFD,CARD,eAeC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAI;AAAO,MAAA,OAAO,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uEAAJ,eACC;AAAO,MAAA,IAAI,EAAC,MAAZ;AAAmB,MAAA,IAAI,EAAC,WAAxB;AAAoC,MAAA,KAAK,EAAE,KAAKP,KAAL,CAAWM,SAAtD;AAAiE,MAAA,WAAW,EAAC,wMAA7E;AAAsH,MAAA,QAAQ,EAAE,KAAKM,YAArI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,CAfD,eAiBC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAI;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sHAAJ,CAjBD,CADD,CAHD,CA1BD,CAFD,CADD;AAyDA;;AAtK0C","sourcesContent":["import React, { Component } from 'react';\r\nimport axios from 'axios';\r\nimport * as jwt_decode from 'jwt-decode';\r\nimport Head from '../components/Head.js'\r\n\r\nexport default class Sign extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tlogin: '',\r\n\t\t\tpassword: '',\r\n\t\t\trole: 'teacher',\r\n\t\t\tschoolName: '',\r\n\t\t\tschool: '',\r\n\t\t\tnewSchool: '',\r\n\t\t\tname: '',\r\n\t\t\tstatus: '',\r\n\t\t\tschools: []\r\n\t\t};\r\n\t\tthis.handleSubmit = this.handleSubmit.bind(this);\r\n\t\tthis.handleChange = this.handleChange.bind(this);\r\n\t\taxios.get(`/schools`).then(res => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tschools: res.data\r\n\t\t\t});\r\n\t\t}).catch(error => {\r\n\t\t\tconsole.log(error);\r\n\t\t});\r\n\t}\r\n\r\n\thandleChange(event) {\r\n\t\tif (event.target.name === 'school') {\r\n\t\t\tthis.setState({\r\n\t\t\t\tschoolname: event.target.value\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\t[event.target.name]: event.target.value\r\n\t\t});\r\n\t}\r\n\r\n\thandleSubmit(event) {\r\n\t\tevent.preventDefault();\r\n\t\tvar radio = document.getElementsByName('form');\r\n\t\tfor (var i = 0; i < radio.length; i++) {\r\n\t\t\tif (radio[i].checked) {\r\n\t\t\t\tvar path = radio[i].id;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (path === 'signin') {\r\n\t\t\taxios.post(path, {\r\n\t\t\t\tlogin: this.state.login,\r\n\t\t\t\tpassword: this.state.password,\r\n\t\t\t\trole: this.state.role\r\n\t\t\t}).then(res => {\r\n\t\t\t\tlocalStorage.setItem('token', res.data);\r\n\t\t\t\tvar token = jwt_decode(res.data);\r\n\t\t\t\tif (token.class) {\r\n\t\t\t\t\tthis.props.history.push({\r\n\t\t\t\t\t\tpathname: `/student`,\r\n\t\t\t\t\t\tstate: {\r\n\t\t\t\t\t\t\tuser: token\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (token.school) {\r\n\t\t\t\t\tthis.props.history.push({\r\n\t\t\t\t\t\tpathname: `/teacher`,\r\n\t\t\t\t\t\tstate: {\r\n\t\t\t\t\t\t\tuser: token\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}).catch(error => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tstatus: <div className=\"error\">Пользователь не найден</div>\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\taxios.post(path, {\r\n\t\t\t\tname: this.state.name,\r\n\t\t\t\tlogin: this.state.login,\r\n\t\t\t\tpassword: this.state.password,\r\n\t\t\t\tschool: this.state.school,\r\n\t\t\t\tnewSchool: this.state.newSchool\r\n\t\t\t}).then(res => {\r\n\t\t\t\tif (res.data) {\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\tstatus: <div className=\"success\">Регистрация пройдена</div>\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\tname: '',\r\n\t\t\t\t\t\tlogin: '',\r\n\t\t\t\t\t\tpassword: '',\r\n\t\t\t\t\t\tschool: '',\r\n\t\t\t\t\t\tnewSchool: ''\r\n\t\t\t\t\t});\r\n\t\t\t\t\tdocument.getElementById('signin').checked = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\tstatus: <div className=\"error\">Пользователь уже существует</div>\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}).catch(error => {\r\n\t\t\t\tif (error.response.status == 304) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tstatus: <div className=\"error\">Ошибка регистрации</div>\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<Head/>\r\n\t\t\t\t<div id=\"form\">\r\n\t\t\t\t\t\t<input type=\"radio\" id=\"signin\" name=\"form\" value=\"\" defaultChecked />\r\n\t\t\t\t\t\t<label htmlFor=\"signin\">Вход</label>\r\n\t\t\t\t\t\t<div id=\"sign\">\r\n\t\t\t\t\t\t\t<label>Введите данные для входа</label>\r\n\t\t\t\t\t\t\t{this.state.status}\r\n\t\t\t\t\t\t\t<form onSubmit={this.handleSubmit}>\r\n\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t<li><label htmlFor=\"login\">Логин</label>\r\n\t\t\t\t\t\t\t\t\t\t<input type=\"text\" name=\"login\" value={this.state.login} onChange={this.handleChange} /></li>\r\n\t\t\t\t\t\t\t\t\t<li><label htmlFor=\"password\">Пароль</label>\r\n\t\t\t\t\t\t\t\t\t\t<input type=\"password\" name=\"password\" value={this.state.password} onChange={this.handleChange}/></li>\r\n\t\t\t\t\t\t\t\t\t\t<label>Роль</label>\r\n\t\t\t\t\t\t\t\t\t<li className=\"radio\"><input type=\"radio\" id=\"teach\" name=\"role\" value=\"teacher\" onChange={this.handleChange} defaultChecked />\r\n\t\t\t\t\t\t\t\t\t\t<label htmlFor=\"teach\">Учитель</label>\r\n\t\t\t\t\t\t\t\t\t\t<input type=\"radio\"/>\r\n\t\t\t\t\t\t\t\t\t\t<label> / </label>\r\n\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"stud\" name=\"role\"  value=\"student\" onChange={this.handleChange}/>\r\n\t\t\t\t\t\t\t\t\t\t<label htmlFor=\"stud\">Ученик</label></li>\r\n\t\t\t\t\t\t\t\t\t<li><button type=\"submit\">Войти</button></li>\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</form>\r\n\t\t\t\t\t\t</div>  \r\n\t\t\t\t\t\t<label> / </label>\r\n\t\t\t\t\t\t<input type=\"radio\" id=\"signup\" name=\"form\" value=\"\"/>\r\n\t\t\t\t\t\t<label htmlFor=\"signup\">Регистрация</label>\r\n\t\t\t\t\t<div id=\"reg\">\r\n\t\t\t\t\t\t<label>Введите данные</label>\r\n\t\t\t\t\t\t{this.state.status}\r\n\t\t\t\t\t\t<form onSubmit={this.handleSubmit}>\r\n\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t<li><label htmlFor=\"name\">Имя</label>\r\n\t\t\t\t\t\t\t\t\t<input type=\"text\" name=\"name\" value={this.state.name} onChange={this.handleChange}/></li> \r\n\t\t\t\t\t\t\t\t<li><label htmlFor=\"login\">Логин</label>\r\n\t\t\t\t\t\t\t\t\t<input type=\"text\" name=\"login\"  autoComplete=\"off\" value={this.state.login} onChange={this.handleChange}/></li>\r\n\t\t\t\t\t\t\t\t<li><label htmlFor=\"password\">Пароль</label>\r\n\t\t\t\t\t\t\t\t\t<input type=\"password\" name=\"password\"  autoComplete=\"off\" value={this.state.password} onChange={this.handleChange}/></li>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t<label htmlFor=\"school\">Школа</label>\r\n\t\t\t\t\t\t\t\t\t<select name=\"school\" onChange={this.handleChange} >\r\n\t\t\t\t\t\t\t\t\t<option value=\"\"></option>\r\n\t\t\t\t\t\t\t\t\t\t{this.state.schools.map(item => <option key={item.id} value={item.id}>{item.name}</option>)};\r\n\t\t\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t<li><label htmlFor=\"newSchool\">Новая школа</label>\r\n\t\t\t\t\t\t\t\t\t<input type=\"text\" name=\"newSchool\" value={this.state.newSchool} placeholder=\"Создайте новую если вашей нет в списке\" onChange={this.handleChange}/></li>\r\n\t\t\t\t\t\t\t\t<li><button type=\"submit\">Зарегистрироваться</button></li>\r\n\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t);\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}